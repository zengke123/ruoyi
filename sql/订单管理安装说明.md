# 订单管理功能安装说明

## 功能概述

订单管理模块提供完整的订单管理功能，包括：
- ✅ 订单列表查询（支持多条件搜索）
- ✅ 新增订单
- ✅ 编辑订单
- ✅ 删除订单（支持批量删除）
- ✅ 查看订单详情
- ✅ 订单编号唯一性校验
- ✅ 订单状态管理（待处理、已确认、配送中、已完成、已取消）
- ✅ 支付状态管理（未支付、已支付、已退款）
- ✅ 自动计算订单总金额

## 安装步骤

### 1. 执行数据库脚本

按照以下顺序执行 SQL 脚本：

```bash
# 1. 创建订单表和菜单权限
mysql -u用户名 -p 数据库名 < sql/sys_order.sql

# 2. 创建数据字典（订单状态和支付状态）
mysql -u用户名 -p 数据库名 < sql/sys_order_dict.sql
```

### 2. 文件清单

已创建的文件如下：

#### 后端文件：
- `ruoyi-system/src/main/java/com/ruoyi/system/domain/SysOrder.java` - 订单实体类
- `ruoyi-system/src/main/java/com/ruoyi/system/mapper/SysOrderMapper.java` - 数据访问接口
- `ruoyi-system/src/main/resources/mapper/system/SysOrderMapper.xml` - MyBatis映射文件
- `ruoyi-system/src/main/java/com/ruoyi/system/service/ISysOrderService.java` - 服务接口
- `ruoyi-system/src/main/java/com/ruoyi/system/service/impl/SysOrderServiceImpl.java` - 服务实现
- `ruoyi-admin/src/main/java/com/ruoyi/web/controller/system/SysOrderController.java` - 控制器

#### 前端文件：
- `ruoyi-admin/src/main/resources/templates/system/order/order.html` - 订单列表页面
- `ruoyi-admin/src/main/resources/templates/system/order/add.html` - 新增订单页面
- `ruoyi-admin/src/main/resources/templates/system/order/edit.html` - 编辑订单页面
- `ruoyi-admin/src/main/resources/templates/system/order/detail.html` - 订单详情页面

#### SQL文件：
- `sql/sys_order.sql` - 数据表和菜单权限
- `sql/sys_order_dict.sql` - 数据字典

### 3. 重启项目

执行 SQL 脚本后，重启若依项目：

```bash
# 如果使用 Maven
mvn clean package
java -jar ruoyi-admin/target/ruoyi-admin.jar

# 或使用项目提供的脚本
./ry.sh
```

### 4. 分配权限

1. 登录系统（默认账号：admin/admin123）
2. 进入【系统管理】->【菜单管理】
3. 找到新增的【订单管理】菜单
4. 进入【系统管理】->【角色管理】
5. 为需要使用订单管理的角色分配相应权限

### 5. 访问订单管理

在左侧菜单栏找到【订单管理】即可使用。

## 数据库表结构

### sys_order 表

| 字段名 | 类型 | 说明 |
|--------|------|------|
| order_id | bigint(20) | 订单ID（主键）|
| order_no | varchar(50) | 订单编号（唯一）|
| customer_name | varchar(50) | 客户姓名 |
| customer_phone | varchar(20) | 客户电话 |
| product_name | varchar(100) | 商品名称 |
| quantity | int(11) | 数量 |
| unit_price | decimal(10,2) | 单价 |
| total_amount | decimal(10,2) | 总金额 |
| order_status | char(1) | 订单状态 |
| payment_status | char(1) | 支付状态 |
| shipping_address | varchar(200) | 收货地址 |
| create_by | varchar(64) | 创建者 |
| create_time | datetime | 创建时间 |
| update_by | varchar(64) | 更新者 |
| update_time | datetime | 更新时间 |
| remark | varchar(500) | 备注 |

## 功能特性

### 1. 搜索功能
- 订单编号（模糊搜索）
- 客户姓名（模糊搜索）
- 客户电话（模糊搜索）
- 商品名称（模糊搜索）
- 订单状态（精确匹配）
- 支付状态（精确匹配）
- 创建时间范围

### 2. 订单状态
- 0 - 待处理
- 1 - 已确认
- 2 - 配送中
- 3 - 已完成
- 4 - 已取消

### 3. 支付状态
- 0 - 未支付
- 1 - 已支付
- 2 - 已退款

### 4. 数据验证
- 订单编号：必填，不超过50字符，唯一性校验
- 客户姓名：必填，不超过50字符
- 客户电话：必填，不超过20字符
- 商品名称：必填，不超过100字符
- 数量：必填，必须大于0
- 单价：必填，必须大于等于0
- 收货地址：不超过200字符
- 总金额：自动计算（数量 × 单价）

## 使用示例

### 新增订单
1. 点击【新增】按钮
2. 填写订单信息
3. 数量和单价输入后会自动计算总金额
4. 点击【提交】保存

### 编辑订单
1. 在订单列表中点击【编辑】按钮
2. 修改订单信息
3. 点击【提交】保存

### 删除订单
- 单个删除：点击订单行的【删除】按钮
- 批量删除：勾选多个订单，点击顶部【删除】按钮

## 注意事项

1. 订单编号必须唯一，新增时会自动校验
2. 总金额由数量和单价自动计算，无需手动输入
3. 删除订单操作不可恢复，请谨慎操作
4. 建议根据实际业务需求调整字段长度和验证规则

## 后续扩展建议

1. 增加订单详情表，支持一个订单包含多个商品
2. 增加客户管理模块，与订单关联
3. 增加商品管理模块，订单选择商品时从商品库中选择
4. 增加订单统计报表功能
5. 增加订单导出功能
6. 增加订单打印功能
7. 增加订单状态流转控制（如：待处理->已确认->配送中->已完成）
8. 增加支付接口对接
9. 增加物流跟踪功能

## 技术支持

如有问题，请参考若依官方文档：http://doc.ruoyi.vip/
